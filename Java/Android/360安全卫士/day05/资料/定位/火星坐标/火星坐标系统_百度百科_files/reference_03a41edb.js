F.module("/static/lemma/ui/view/reference/reference.js",function(j,l){var g=j("/static/common/lib/tangram/base/base.js");var n=j("/static/common/ui/nslog/nslog.js");var i=null;var h=[];var b=0;function f(r){g.dom.addClass(g.g("reference-"+r+"-wrap"),"reference_highlight")}function e(r){r.className="reference_highlight"}function a(v){var r=document.getElementById("content").getElementsByTagName("a"),u=null;for(var t=0;u=r[t];t++){if(u.name===v||(u.getAttribute("data-collapsed")&&s(u.name,v))){break}}if(!u){return null}return u.previousSibling;function s(w,y){var z=w.split("_")[1].replace(/\[|\]/g,"").split("&"),x=y.split("_")[1].replace(/\[|\]/g,"");if(+x<=+z[1]&&+x>=+z[0]){return 1}return 0}}function o(v,t){var r=[],u=v.substr(1,v.length-2).split("-");if(u.length==1){r.push("["+u[0]+"]-"+t)}else{for(var s=(+u[0]);s<=(+u[1]);s++){r.push("["+s+"]-"+t)}}return r}function m(r){var s=parseInt(g.dom.getPosition(r).top)-50;if(s>0){window.scrollTo(0,s)}}function k(){i&&(i.className="")}function d(){for(var r=0,s;s=h[r];r++){g.dom.removeClass(g.g("reference-"+s+"-wrap"),"reference_highlight")}}function q(u,r){d();k();var t=o(u.innerHTML,r);h=t;lastFromSup=u;for(var s=0;s<t.length;s++){f(t[s])}g("#viewRefer").removeClass("collapse");g("#viewRefer li").css("display","list-item");location.hash="reference-"+t[0]+"-wrap";m(g.g("reference-"+t[0]+"-wrap"));if(!b){setTimeout(function(){m(g.g("reference-"+t[0]+"-wrap"))},800)}}function c(u){var s=u.href.substr(u.href.indexOf("#")+1);k();d();if(t(s)){var r=lastFromSup}else{var r=a(s)}i=r;e(r);m(r);function t(w){for(var v=0;v<h.length;v++){if(("ref-"+h[v])==(w.split("_").join("-"))){return 1}}return 0}}function p(){g.on("content","click",function(x){var s=g.event.get(x);var w=s.target;if(w.nodeName.toUpperCase()!=="SUP"){return}var u=g.dom.next(w);if(!u||u.nodeName.toUpperCase()!=="A"||!u.getAttribute("name")){return}var t=u.getAttribute("name");var v=t.split("_");if(v.length>2){index=v[v.length-1]}u=null;q(w,index);n(window.location.href,1970)});g(".ref-top").click(function(){var s=g(this).attr("id");var s=s.replace(/refIndex_(\d+)_/,"ref_[$1]_");location.hash=s});var r=g(".viewRefer li")}l.init=p;l.referenceClick=c;return l},["/static/common/lib/tangram/base/base.js","/static/common/ui/nslog/nslog.js"]);